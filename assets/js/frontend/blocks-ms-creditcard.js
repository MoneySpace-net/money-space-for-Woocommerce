(()=>{"use strict";const e=window.React,t=window.wc.wcSettings,c=window.wp.htmlEntities,a=window.wc.wcBlocksRegistry,n=window.wp.element,r=(window.wp.i18n,t=>{const c={ccNo:"",ccName:"",ccExpMonth:"",ccExpYear:"",ccCVV:"",cardYear:"",minCardYear:(new Date).getFullYear(),dirty:!1},[a,r]=(0,n.useState)(c),[o,l]=(0,n.useState)({}),{eventRegistration:i={},i18n:s={}}=t,{onPaymentSetup:d,onCheckoutValidation:m}=i,p=()=>{const e=document.getElementById("radio-control-wc-payment-method-options-moneyspace");return!!e&&e.checked},u=(0,n.useCallback)((()=>{const e={};if(!p())return{};const t=a.ccNo.replaceAll(" ","");if(t?t.length<16?e.ccNo=s.MNS_CC_WARN_CC_NO_2||"Card number must be 16 digits":/^\d{16}$/.test(t)||(e.ccNo="Card number must contain only digits"):e.ccNo=s.MNS_CC_WARN_CC_NO_1||"Card number is required",a.ccName.trim()?a.ccName.trim().length<2&&(e.ccName="Cardholder name must be at least 2 characters"):e.ccName=s.MNS_CC_WARN_CC_NAME||"Cardholder name is required",a.ccExpMonth){const t=parseInt(a.ccExpMonth);(t<1||t>12)&&(e.ccExpMonth="Please select a valid month")}else e.ccExpMonth=s.MNS_CC_WARN_CC_EXP_MONTH||"Expiry month is required";if(a.ccExpYear){const t=(new Date).getFullYear();parseInt(a.ccExpYear)<t&&(e.ccExpYear="Card has expired")}else e.ccExpYear=s.MNS_CC_WARN_CC_EXP_YEAR||"Expiry year is required";if(a.ccExpMonth&&a.ccExpYear){const t=new Date,c=t.getFullYear(),n=t.getMonth()+1,r=parseInt(a.ccExpYear),o=parseInt(a.ccExpMonth);r===c&&o<n&&(e.ccExpMonth="Card has expired")}return a.ccCVV?a.ccCVV.length<3?e.ccCVV=s.MNS_CC_WARN_CVV_2||"CVV must be 3 digits":/^\d{3,4}$/.test(a.ccCVV)||(e.ccCVV="CVV must contain only digits"):e.ccCVV=s.MNS_CC_WARN_CVV_1||"CVV is required",e}),[a,s]);(0,n.useEffect)((()=>{if(a.dirty){const e=u();l(e)}}),[a,u]),(({formData:e,onPaymentSetup:t})=>{(0,n.useEffect)((()=>{if(t)return t((()=>e))}),[e,t])})({formData:a,onPaymentSetup:d}),(({formData:e,onPaymentSetup:t})=>{(0,n.useEffect)((()=>{if(t)return t((()=>({type:"success",meta:{paymentMethodData:{cardNumber:e.ccNo.replaceAll(" ",""),cardHolder:e.ccName,cardExpDate:e.ccExpMonth,cardExpDateYear:e.ccExpYear,cardCVV:e.ccCVV}},paymentMethodData:{cardNumber:e.ccNo.replaceAll(" ",""),cardHolder:e.ccName,cardExpDate:e.ccExpMonth,cardExpDateYear:e.ccExpYear,cardCVV:e.ccCVV}})))}),[e,t])})({formData:a,onPaymentSetup:d}),(({formData:e,onCheckoutValidation:t})=>{(0,n.useEffect)((()=>{if(t)return t((()=>{if(!p())return!0;e.dirty||r((e=>({...e,dirty:!0})));const t=u();return!(Object.keys(t).length>0)||(l(t),{errorMessage:`Payment validation failed: ${Object.values(t)[0]}`})}))}),[e,t,u])})({formData:a,onCheckoutValidation:m});const C=e=>a.dirty&&o[e]?"has-error":"",E=t=>a.dirty&&o[t]?(0,e.createElement)("div",{className:"wc-block-components-validation-error",role:"alert"},(0,e.createElement)("p",null,o[t])):null,N=[1,2,3,4,5,6,7,8,9,10,11,12],h=e=>t=>{let c=t.target.value;"ccNo"===e?/^[0-9\s]*$/.test(c)&&(c=(e=>{const t=e.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),c=t&&t[0]||"",a=[];for(let e=0,t=c.length;e<t;e+=4)a.push(c.substring(e,e+4));return a.length?a.join(" "):e})(c),r((t=>({...t,[e]:c,dirty:!0})))):"ccName"===e?(c=c.toUpperCase().replace(/[^A-Z\s]/g,""),r((t=>({...t,[e]:c,dirty:!0})))):"ccCVV"===e?/^[0-9]*$/.test(c)&&c.length<=4&&r((t=>({...t,[e]:c,dirty:!0}))):r((t=>({...t,[e]:c,dirty:!0})))};return(0,e.createElement)("div",{className:"wc-block-components-credit-card-form"},(0,e.createElement)("div",{className:`wc-block-components-text-input wc-block-components-credit-form is-active ${C("ccNo")}`},(0,e.createElement)("input",{type:"text",value:a.ccNo,onChange:h("ccNo"),id:"txtCardNumber",name:"cardNumber",onKeyDown:e=>/^[0-9]*$/.test(e.key)||[8,67,86,88].includes(e.keyCode)?a.ccNo.replaceAll(" ","").length>=16&&![8,67,86,88].includes(e.keyCode)?e.preventDefault():void 0:e.preventDefault(),placeholder:"0000 0000 0000 0000",maxLength:"19"}),(0,e.createElement)("label",{htmlFor:"txtCardNumber"},s.MNS_CC_NO," *"),E("ccNo")),(0,e.createElement)("div",{className:`wc-block-components-text-input wc-block-components-credit-form is-active ${C("ccName")}`},(0,e.createElement)("input",{type:"text",value:a.ccName,onChange:h("ccName"),id:"txtHolder",name:"cardHolder",placeholder:"TONY ELSDEN",maxLength:"50"}),(0,e.createElement)("label",{htmlFor:"txtHolder"},s.MNS_CC_NAME," *"),E("ccName")),(0,e.createElement)("div",{className:`wc-block-components-text-input is-active ${C("ccExpMonth")}`},(0,e.createElement)("select",{value:a.ccExpMonth,onChange:h("ccExpMonth"),id:"txtExpDate",name:"cardExpDate"},(0,e.createElement)("option",{value:"",disabled:!0},s.MNS_MONTH),N.map((t=>(0,e.createElement)("option",{key:t,value:t,disabled:t<(a.ccExpYear&&parseInt(a.ccExpYear)===a.minCardYear?(new Date).getMonth()+1:1)},t<10?"0"+t:t)))),(0,e.createElement)("label",{htmlFor:"txtExpDate"},s.MNS_CC_EXP_MONTH," *"),E("ccExpMonth")),(0,e.createElement)("div",{className:`wc-block-components-text-input is-active ${C("ccExpYear")}`},(0,e.createElement)("select",{value:a.ccExpYear,onChange:h("ccExpYear"),id:"ccExpYear",name:"cardExpDateYear"},(0,e.createElement)("option",{value:"",disabled:!0},s.MNS_YEAR),N.map(((t,c)=>(0,e.createElement)("option",{key:c,value:c+a.minCardYear},c+a.minCardYear)))),(0,e.createElement)("label",{htmlFor:"ccExpYear"},s.MNS_CC_EXP_YEAR," *"),E("ccExpYear")),(0,e.createElement)("div",{className:`wc-block-components-text-input wc-block-components-credit-form is-active ${C("ccCVV")}`},(0,e.createElement)("input",{type:"password",value:a.ccCVV,onChange:h("ccCVV"),id:"txtCVV",name:"cardCVV",maxLength:"4",onKeyDown:e=>/^[0-9]*$/.test(e.key)||[8,67,86,88].includes(e.keyCode)?a.ccCVV.length>=4&&![8,67,86,88].includes(e.keyCode)?e.preventDefault():void 0:e.preventDefault(),placeholder:"000",required:0===a.ccCVV.length&&p()}),(0,e.createElement)("label",{htmlFor:"txtCVV"},s.MNS_CC_CVV," *"),E("ccCVV")))}),o="moneyspace",l=(0,t.getSetting)(`${o}_data`,{}),i=(0,c.decodeEntities)(l.title),s=l.ms_template_payment,d=t=>{const a=(0,n.useMemo)((()=>({i18n:l.i18n,...t})),[t]);return 1==s?(0,e.createElement)(r,{...a}):(0,c.decodeEntities)(l.description||"")},m={name:o,label:i,content:(0,e.createElement)(d,null),edit:(0,e.createElement)(d,null),ariaLabel:i,paymentMethodId:o,canMakePayment:()=>!0,supports:{features:l.supports}};(0,a.registerPaymentMethod)(m)})();